---
import TableReact from '@components/react/Table';
import API from '@utils/api'; // Ajusta la ruta según sea necesario

let items: any[] = [];
let headers: string[] = [];
let loading = true;
const title = "Automobile"; // Define el título de la tabla

const fetchAutomobiles = async () => {
  try {
    const response = await API.get(API.GET_AUTOMOBILES); // Utiliza la clase API
    console.log('API response:', response); // Verificar la respuesta de la API
    items = response.map((item: any) => ({
      ...item,
      Bodywork: item.bodywork.name
    }));
    headers = Object.keys(response[0]).map(header => header === 'bodywork' ? 'Bodywork' : header);
  } catch (error) {
    console.error('Error fetching automobiles:', error);
  } finally {
    loading = false;
  }
};

await fetchAutomobiles();
---

<div class="p-4 m-4 rounded-lg shadow-lg">
  {loading ? (
    <div>Loading...</div>
  ) : (
    <TableReact title={title} items={items} headers={headers} />
  )}
</div>