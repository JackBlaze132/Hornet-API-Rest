---
let automobiles = [];

// Función para obtener los datos desde la API
async function fetchAutomobiles() {
    try {
        const response = await fetch('http://localhost:8090/automobiles/get');
        const data = await response.json();
        automobiles = data; // Guardamos todos los datos de los automóviles
    } catch (error) {
        console.error('Error fetching automobiles:', error);
    }
}
    
// Llamamos a la función cuando se carga el componente
await fetchAutomobiles();
---

<h2>Consulta de Datos</h2>

<h3>Listado de Automóviles</h3>

<table style="border-collapse: collapse; width: 100%;">
    <thead>
        <tr>
        <th style="border: 1px solid black; padding: 10px;">ID</th>
        <th style="border: 1px solid black; padding: 10px;">Marca</th>
        <th style="border: 1px solid black; padding: 10px;">Precio</th>
        <th style="border: 1px solid black; padding: 10px;">Número de Serie (SNID)</th>
        <th style="border: 1px solid black; padding: 10px;">ABS</th>
        <th style="border: 1px solid black; padding: 10px;">Carrocerías</th>
        </tr>
    </thead>
    <tbody>
        {automobiles.map((auto) => (
        <tr>
            <td style="border: 1px solid black; padding: 10px;">{auto.id}</td>
            <td style="border: 1px solid black; padding: 10px;">{auto.brand}</td>
            <td style="border: 1px solid black; padding: 10px;">${auto.price}</td>
            <td style="border: 1px solid black; padding: 10px;">{auto.snid}</td>
            <td style="border: 1px solid black; padding: 10px;">{auto.absBrake ? 'Sí' : 'No'}</td>
            <td style="border: 1px solid black; padding: 10px;">
            <ul style="padding-left: 20px;">
                {auto.bodyworks.map((body) => (
                <li>{body.name}</li>
                ))}
            </ul>
            </td>
        </tr>
        ))}
    </tbody>
</table>
